---
title: Advanced usage
---

## Initialize only once

The `initialize` function can be called only once.

If it is called more than once, `Promise` will be rejected.

## Initialize without buffer

The argument of the `initialize` function can be something other than a buffer.

### Types

```js
export type InitInput =
  | RequestInfo
  | URL
  | Response
  | BufferSource
  | WebAssembly.Module;
export const initialize: (mod: Promise<InitInput> | InitInput) => Promise<void>;
```

### Examples

```js
// full code (WebAsembly.Module)
const response = await fetch(
  'https://unpkg.com/svg2png-wasm/svg2png_wasm_bg.wasm',
);
const buffer = await response.arrayBuffer();
const { module } = await WebAssembly.instantiate(buffer);
await initialize(module);

// BufferSource
const response = await fetch(
  'https://unpkg.com/svg2png-wasm/svg2png_wasm_bg.wasm',
);
const buffer = await response.arrayBuffer();
await initialize(buffer);

// Response
const response = await fetch(
  'https://unpkg.com/svg2png-wasm/svg2png_wasm_bg.wasm',
);
await initialize(response);

// Promise<Response>
await initialize(fetch('https://unpkg.com/svg2png-wasm/svg2png_wasm_bg.wasm'));

// in Deno (Promise<BufferSource>)
await initialize(Deno.readFile('./svg2png_wasm_bg.wasm'));

// in Deno and Browser (RequestInfo (=string/URL))
await initialize('https://unpkg.com/svg2png-wasm/svg2png_wasm_bg.wasm');
```

## Custom svg2png

You can create a custom svg2png function.

Basically, you can use `svg2png` , but if you want to process a lot of data continuously, consider using `createSvg2png` . It can reduce the overhead of font loading. Converters generated by `createSvg2png` should be disposed of after use by calling the dispose method.

```js
const svgs = [
  '<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"> ... </svg>',
  '<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"> ... </svg>',
  '<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"> ... </svg>',
  // and more ...
];
const font = await fetch('./Roboto.ttf').then((res) => res.arrayBuffer());
const svg2png = createSvg2png({
  fonts: [new Uint8Array(font)],
});

const pngs = await Promise.all(svgs.map((svg) => svg2png(svg, { scale: 2 })));
svg2png.dispose(); // You should dispose svg2png, if you will not use it in the future
```
