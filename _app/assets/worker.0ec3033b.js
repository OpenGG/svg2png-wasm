(()=>{(function(){"use strict";var t,S=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});S.decode();var m=null;function v(){return(m===null||m.buffer!==t.memory.buffer)&&(m=new Uint8Array(t.memory.buffer)),m}function E(e,n){return S.decode(v().subarray(e,e+n))}var u=new Array(32).fill(void 0);u.push(void 0,null,!0,!1);var y=u.length;function z(e){y===u.length&&u.push(u.length+1);const n=y;return y=u[n],u[n]=e,n}function T(e){return u[e]}function j(e){e<36||(u[e]=y,y=e)}function C(e){const n=T(e);return j(e),n}var _=0;function I(e,n){const r=n(e.length*1);return v().set(e,r/1),_=e.length,r}var h=new TextEncoder("utf-8"),U=typeof h.encodeInto=="function"?function(e,n){return h.encodeInto(e,n)}:function(e,n){const r=h.encode(e);return n.set(r),{read:e.length,written:r.length}};function b(e,n,r){if(r===void 0){const c=h.encode(e),l=n(c.length);return v().subarray(l,l+c.length).set(c),_=c.length,l}let o=e.length,a=n(o);const s=v();let i=0;for(;i<o;i++){const c=e.charCodeAt(i);if(c>127)break;s[a+i]=c}if(i!==o){i!==0&&(e=e.slice(i)),a=r(a,o,o=i+e.length*3);const c=v().subarray(a+i,a+o);i+=U(e,c).written}return _=i,a}function f(e){return e==null}var F=null;function p(){return(F===null||F.buffer!==t.memory.buffer)&&(F=new Int32Array(t.memory.buffer)),F}function L(e,n){return v().subarray(e/1,e/1+n)}function x(e,n,r,o,a){var s=f(e)?0:b(e,t.__wbindgen_malloc,t.__wbindgen_realloc),i=_,c=f(n)?0:b(n,t.__wbindgen_malloc,t.__wbindgen_realloc),l=_,g=f(r)?0:b(r,t.__wbindgen_malloc,t.__wbindgen_realloc),w=_,M=f(o)?0:b(o,t.__wbindgen_malloc,t.__wbindgen_realloc),A=_,d=f(a)?0:b(a,t.__wbindgen_malloc,t.__wbindgen_realloc),N=_,H=t.createConverter(s,i,c,l,g,w,M,A,d,N);return O.__wrap(H)}var O=class{static __wrap(e){const n=Object.create(O.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();t.__wbg_converter_free(e)}registerFont(e){var n=I(e,t.__wbindgen_malloc),r=_;t.converter_registerFont(this.ptr,n,r)}convert(e,n,r,o){try{const g=t.__wbindgen_add_to_stack_pointer(-16);var a=b(e,t.__wbindgen_malloc,t.__wbindgen_realloc),s=_;t.converter_convert(g,this.ptr,a,s,!f(n),f(n)?0:n,!f(r),f(r)?0:r,!f(o),f(o)?0:o);var i=p()[g/4+0],c=p()[g/4+1],l=L(i,c).slice();return t.__wbindgen_free(i,c*1),l}finally{t.__wbindgen_add_to_stack_pointer(16)}}};async function $(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(o){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,n)}else{const r=await WebAssembly.instantiate(e,n);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}async function R(e){typeof e=="undefined"&&(e=new URL("svg2png_wasm_bg.wasm",void 0));const n={};n.wbg={},n.wbg.__wbindgen_string_new=function(a,s){var i=E(a,s);return z(i)},n.wbg.__wbg_new_693216e109162396=function(){var a=new Error;return z(a)},n.wbg.__wbg_stack_0ddaca5d1abfb52f=function(a,s){var i=T(s).stack,c=b(i,t.__wbindgen_malloc,t.__wbindgen_realloc),l=_;p()[a/4+1]=l,p()[a/4+0]=c},n.wbg.__wbg_error_09919627ac0992f5=function(a,s){try{console.error(E(a,s))}finally{t.__wbindgen_free(a,s)}},n.wbg.__wbindgen_object_drop_ref=function(a){C(a)},n.wbg.__wbindgen_throw=function(a,s){throw new Error(E(a,s))},n.wbg.__wbindgen_rethrow=function(a){throw C(a)},(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:o}=await $(await e,n);return t=r.exports,R.__wbindgen_wasm_module=o,t.__wbindgen_start(),t}var q=R,W=!1,B=async e=>{if(W)throw new Error("Already initialized. The `initialize` function can be used only once.");await q(await e),W=!0},D=e=>{var o,a,s,i,c,l;if(!W)throw new Error("WASM has not been initialized. Call `initialize` function.");let n;n=x((o=e==null?void 0:e.defaultFontFamily)==null?void 0:o.serifFamily,(a=e==null?void 0:e.defaultFontFamily)==null?void 0:a.sansSerifFamily,(s=e==null?void 0:e.defaultFontFamily)==null?void 0:s.cursiveFamily,(i=e==null?void 0:e.defaultFontFamily)==null?void 0:i.fantasyFamily,(c=e==null?void 0:e.defaultFontFamily)==null?void 0:c.monospaceFamily);for(const g of(l=e==null?void 0:e.fonts)!=null?l:[])n.registerFont(g);const r=(g,w)=>new Promise((M,A)=>{try{const d=n==null?void 0:n.convert(g,w==null?void 0:w.scale,w==null?void 0:w.width,w==null?void 0:w.height);if(d)M(d);else throw new Error("Converter already disposed.")}catch(d){d instanceof Error?A(d):A(new Error(`${d}`))}});return r.dispose=()=>{n==null||n.free(),n=void 0},r};console.log("worker initializing");let k;self.addEventListener("message",e=>{const n=e.data;if(!(typeof n!="object"||n==null))switch(console.log(`worker ${n.type}`),n.type){case"initialize":B(fetch("/svg2png-wasm/svg2png.wasm")).then(()=>{k=D(n.options)});break;case"svg2png":k===void 0?self.postMessage({type:"error",error:"svg2png has not been initialized."}):k(n.svg,n.options).then(r=>self.postMessage({id:n.id,type:"success",data:r})).catch(r=>self.postMessage({id:n.id,type:"error",error:`${r}`}));break}})})();})();
