(()=>{(function(){"use strict";var r,S=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});S.decode();var F=null;function y(){return(F===null||F.buffer!==r.memory.buffer)&&(F=new Uint8Array(r.memory.buffer)),F}function W(e,n){return S.decode(y().subarray(e,e+n))}var g=new Array(32).fill(void 0);g.push(void 0,null,!0,!1);var m=g.length;function z(e){m===g.length&&g.push(g.length+1);const n=m;return m=g[n],g[n]=e,n}function C(e){return g[e]}function j(e){e<36||(g[e]=m,m=e)}function T(e){const n=C(e);return j(e),n}var f=0;function I(e,n){const t=n(e.length*1);return y().set(e,t/1),f=e.length,t}var A=new TextEncoder("utf-8"),U=typeof A.encodeInto=="function"?function(e,n){return A.encodeInto(e,n)}:function(e,n){const t=A.encode(e);return n.set(t),{read:e.length,written:t.length}};function u(e,n,t){if(t===void 0){const o=A.encode(e),_=n(o.length);return y().subarray(_,_+o.length).set(o),f=o.length,_}let c=e.length,a=n(c);const l=y();let i=0;for(;i<c;i++){const o=e.charCodeAt(i);if(o>127)break;l[a+i]=o}if(i!==c){i!==0&&(e=e.slice(i)),a=t(a,c,c=i+e.length*3);const o=y().subarray(a+i,a+c);i+=U(e,o).written}return f=i,a}function w(e){return e==null}var p=null;function E(){return(p===null||p.buffer!==r.memory.buffer)&&(p=new Int32Array(r.memory.buffer)),p}function L(e,n){return y().subarray(e/1,e/1+n)}function x(e,n,t,c,a){var l=w(e)?0:u(e,r.__wbindgen_malloc,r.__wbindgen_realloc),i=f,o=w(n)?0:u(n,r.__wbindgen_malloc,r.__wbindgen_realloc),_=f,d=w(t)?0:u(t,r.__wbindgen_malloc,r.__wbindgen_realloc),s=f,h=w(c)?0:u(c,r.__wbindgen_malloc,r.__wbindgen_realloc),b=f,v=w(a)?0:u(a,r.__wbindgen_malloc,r.__wbindgen_realloc),N=f,H=r.createConverter(l,i,o,_,d,s,h,b,v,N);return O.__wrap(H)}var O=class{static __wrap(e){const n=Object.create(O.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_converter_free(e)}registerFont(e){var n=I(e,r.__wbindgen_malloc),t=f;r.converter_registerFont(this.ptr,n,t)}convert(e,n,t,c,a){try{const b=r.__wbindgen_add_to_stack_pointer(-16);var l=u(e,r.__wbindgen_malloc,r.__wbindgen_realloc),i=f,o=w(a)?0:u(a,r.__wbindgen_malloc,r.__wbindgen_realloc),_=f;r.converter_convert(b,this.ptr,l,i,!w(n),w(n)?0:n,!w(t),w(t)?0:t,!w(c),w(c)?0:c,o,_);var d=E()[b/4+0],s=E()[b/4+1],h=L(d,s).slice();return r.__wbindgen_free(d,s*1),h}finally{r.__wbindgen_add_to_stack_pointer(16)}}};async function $(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(c){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",c);else throw c}const t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}else{const t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}async function R(e){typeof e=="undefined"&&(e=new URL("svg2png_wasm_bg.wasm",void 0));const n={};n.wbg={},n.wbg.__wbindgen_string_new=function(a,l){var i=W(a,l);return z(i)},n.wbg.__wbg_new_693216e109162396=function(){var a=new Error;return z(a)},n.wbg.__wbg_stack_0ddaca5d1abfb52f=function(a,l){var i=C(l).stack,o=u(i,r.__wbindgen_malloc,r.__wbindgen_realloc),_=f;E()[a/4+1]=_,E()[a/4+0]=o},n.wbg.__wbg_error_09919627ac0992f5=function(a,l){try{console.error(W(a,l))}finally{r.__wbindgen_free(a,l)}},n.wbg.__wbindgen_object_drop_ref=function(a){T(a)},n.wbg.__wbindgen_throw=function(a,l){throw new Error(W(a,l))},n.wbg.__wbindgen_rethrow=function(a){throw T(a)},(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:c}=await $(await e,n);return r=t.exports,R.__wbindgen_wasm_module=c,r.__wbindgen_start(),r}var q=R,k=!1,B=async e=>{if(k)throw new Error("Already initialized. The `initialize` function can be used only once.");await q(await e),k=!0},D=e=>{var c,a,l,i,o,_;if(!k)throw new Error("WASM has not been initialized. Call `initialize` function.");let n;n=x((c=e==null?void 0:e.defaultFontFamily)==null?void 0:c.serifFamily,(a=e==null?void 0:e.defaultFontFamily)==null?void 0:a.sansSerifFamily,(l=e==null?void 0:e.defaultFontFamily)==null?void 0:l.cursiveFamily,(i=e==null?void 0:e.defaultFontFamily)==null?void 0:i.fantasyFamily,(o=e==null?void 0:e.defaultFontFamily)==null?void 0:o.monospaceFamily);for(const d of(_=e==null?void 0:e.fonts)!=null?_:[])n.registerFont(d);const t=(d,s)=>new Promise((h,b)=>{try{const v=n==null?void 0:n.convert(d,s==null?void 0:s.scale,s==null?void 0:s.width,s==null?void 0:s.height,s==null?void 0:s.backgroundColor);if(v)h(v);else throw new Error("Converter already disposed.")}catch(v){v instanceof Error?b(v):b(new Error(`${v}`))}});return t.dispose=()=>{n==null||n.free(),n=void 0},t};console.log("worker initializing");let M;self.addEventListener("message",e=>{const n=e.data;if(!(typeof n!="object"||n==null))switch(console.log(`worker ${n.type}`),n.type){case"initialize":B("/svg2png-wasm/svg2png.wasm").then(()=>{M=D(n.options)});break;case"svg2png":M===void 0?self.postMessage({type:"error",error:"svg2png has not been initialized."}):M(n.svg,n.options).then(t=>self.postMessage({id:n.id,type:"success",data:t})).catch(t=>self.postMessage({id:n.id,type:"error",error:`${t}`}));break}})})();})();
