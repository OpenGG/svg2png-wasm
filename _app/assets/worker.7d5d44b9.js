(()=>{(function(){"use strict";var r,z=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});z.decode();var A=null;function v(){return(A===null||A.buffer!==r.memory.buffer)&&(A=new Uint8Array(r.memory.buffer)),A}function W(e,n){return z.decode(v().subarray(e,e+n))}var d=new Array(32).fill(void 0);d.push(void 0,null,!0,!1);var h=d.length;function C(e){h===d.length&&d.push(d.length+1);const n=h;return h=d[n],d[n]=e,n}function T(e){return d[e]}function j(e){e<36||(d[e]=h,h=e)}function E(e){const n=T(e);return j(e),n}var f=0;function I(e,n){const t=n(e.length*1);return v().set(e,t/1),f=e.length,t}var p=new TextEncoder("utf-8"),L=typeof p.encodeInto=="function"?function(e,n){return p.encodeInto(e,n)}:function(e,n){const t=p.encode(e);return n.set(t),{read:e.length,written:t.length}};function g(e,n,t){if(t===void 0){const l=p.encode(e),_=n(l.length);return v().subarray(_,_+l.length).set(l),f=l.length,_}let i=e.length,a=n(i);const c=v();let o=0;for(;o<i;o++){const l=e.charCodeAt(o);if(l>127)break;c[a+o]=l}if(o!==i){o!==0&&(e=e.slice(o)),a=t(a,i,i=o+e.length*3);const l=v().subarray(a+o,a+i);o+=L(e,l).written}return f=o,a}function u(e){return e==null}var k=null;function m(){return(k===null||k.buffer!==r.memory.buffer)&&(k=new Int32Array(r.memory.buffer)),k}function x(e,n){return v().subarray(e/1,e/1+n)}var M=null;function $(){return(M===null||M.buffer!==r.memory.buffer)&&(M=new Uint32Array(r.memory.buffer)),M}function q(e,n){const i=$().subarray(e/4,e/4+n),a=[];for(let c=0;c<i.length;c++)a.push(E(i[c]));return a}function B(e,n,t,i,a){var c=u(e)?0:g(e,r.__wbindgen_malloc,r.__wbindgen_realloc),o=f,l=u(n)?0:g(n,r.__wbindgen_malloc,r.__wbindgen_realloc),_=f,w=u(t)?0:g(t,r.__wbindgen_malloc,r.__wbindgen_realloc),s=f,F=u(i)?0:g(i,r.__wbindgen_malloc,r.__wbindgen_realloc),b=f,y=u(a)?0:g(a,r.__wbindgen_malloc,r.__wbindgen_realloc),J=f,P=r.createConverter(c,o,l,_,w,s,F,b,y,J);return O.__wrap(P)}var O=class{static __wrap(e){const n=Object.create(O.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_converter_free(e)}registerFont(e){var n=I(e,r.__wbindgen_malloc),t=f;r.converter_registerFont(this.ptr,n,t)}convert(e,n,t,i,a){try{const b=r.__wbindgen_add_to_stack_pointer(-16);var c=g(e,r.__wbindgen_malloc,r.__wbindgen_realloc),o=f,l=u(a)?0:g(a,r.__wbindgen_malloc,r.__wbindgen_realloc),_=f;r.converter_convert(b,this.ptr,c,o,!u(n),u(n)?0:n,!u(t),u(t)?0:t,!u(i),u(i)?0:i,l,_);var w=m()[b/4+0],s=m()[b/4+1],F=x(w,s).slice();return r.__wbindgen_free(w,s*1),F}finally{r.__wbindgen_add_to_stack_pointer(16)}}list_fonts(){try{const i=r.__wbindgen_add_to_stack_pointer(-16);r.converter_list_fonts(i,this.ptr);var e=m()[i/4+0],n=m()[i/4+1],t=q(e,n).slice();return r.__wbindgen_free(e,n*4),t}finally{r.__wbindgen_add_to_stack_pointer(16)}}};async function D(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(i){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}else{const t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}async function R(e){typeof e=="undefined"&&(e=new URL("svg2png_wasm_bg.wasm",void 0));const n={};n.wbg={},n.wbg.__wbindgen_string_new=function(a,c){var o=W(a,c);return C(o)},n.wbg.__wbg_new_693216e109162396=function(){var a=new Error;return C(a)},n.wbg.__wbg_stack_0ddaca5d1abfb52f=function(a,c){var o=T(c).stack,l=g(o,r.__wbindgen_malloc,r.__wbindgen_realloc),_=f;m()[a/4+1]=_,m()[a/4+0]=l},n.wbg.__wbg_error_09919627ac0992f5=function(a,c){try{console.error(W(a,c))}finally{r.__wbindgen_free(a,c)}},n.wbg.__wbindgen_object_drop_ref=function(a){E(a)},n.wbg.__wbindgen_throw=function(a,c){throw new Error(W(a,c))},n.wbg.__wbindgen_rethrow=function(a){throw E(a)},(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:i}=await D(await e,n);return r=t.exports,R.__wbindgen_wasm_module=i,r.__wbindgen_start(),r}var N=R,S=!1,V=async e=>{if(S)throw new Error("Already initialized. The `initialize` function can be used only once.");await N(await e),S=!0},H=e=>{var i,a,c,o,l,_;if(!S)throw new Error("WASM has not been initialized. Call `initialize` function.");let n;n=B((i=e==null?void 0:e.defaultFontFamily)==null?void 0:i.serifFamily,(a=e==null?void 0:e.defaultFontFamily)==null?void 0:a.sansSerifFamily,(c=e==null?void 0:e.defaultFontFamily)==null?void 0:c.cursiveFamily,(o=e==null?void 0:e.defaultFontFamily)==null?void 0:o.fantasyFamily,(l=e==null?void 0:e.defaultFontFamily)==null?void 0:l.monospaceFamily);for(const w of(_=e==null?void 0:e.fonts)!=null?_:[])n.registerFont(w);const t=(w,s)=>new Promise((F,b)=>{try{const y=n==null?void 0:n.convert(w,s==null?void 0:s.scale,s==null?void 0:s.width,s==null?void 0:s.height,s==null?void 0:s.backgroundColor);if(y)F(y);else throw new Error("Converter already disposed.")}catch(y){y instanceof Error?b(y):b(new Error(`${y}`))}});return t.dispose=()=>{n==null||n.free(),n=void 0},t.getLoadedFontFamilies=()=>{var w;return(w=n==null?void 0:n.list_fonts())!=null?w:[]},t};console.log("worker initializing");let U;self.addEventListener("message",e=>{const n=e.data;if(!(typeof n!="object"||n==null))switch(console.log(`worker ${n.type}`),n.type){case"initialize":V("/svg2png-wasm/svg2png.wasm").then(()=>{U=H(n.options)});break;case"svg2png":U===void 0?self.postMessage({type:"error",error:"svg2png has not been initialized."}):U(n.svg,n.options).then(t=>self.postMessage({id:n.id,type:"success",data:t})).catch(t=>self.postMessage({id:n.id,type:"error",error:`${t}`}));break}})})();})();
